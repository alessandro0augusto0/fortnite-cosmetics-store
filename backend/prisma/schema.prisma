generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "debian-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           String        @id @default(uuid())
  email        String        @unique
  password     String
  vbucks       Int           @default(10000)
  createdAt    DateTime      @default(now())
  items        UserItem[]
  transactions Transaction[]
}

model Cosmetic {
  id            String        @id
  name          String
  description   String?
  type          String
  rarity        String
  image         String?
  price         Int           @default(0)
  addedAt       DateTime
  isNew         Boolean       @default(false)
  isOnSale      Boolean       @default(false)
  lastSync      DateTime      @default(now())
  items         UserItem[]
  transactions  Transaction[]
}

model UserItem {
  id         String   @id @default(uuid())
  userId     String
  cosmeticId String
  acquiredAt DateTime @default(now())

  user     User     @relation(fields: [userId], references: [id])
  cosmetic Cosmetic @relation(fields: [cosmeticId], references: [id])

  @@unique([userId, cosmeticId])
}

model Transaction {
  id         String   @id @default(uuid())
  userId     String
  cosmeticId String
  type       String
  amount     Int
  date       DateTime @default(now())

  user     User     @relation(fields: [userId], references: [id])
  cosmetic Cosmetic @relation(fields: [cosmeticId], references: [id])
}
